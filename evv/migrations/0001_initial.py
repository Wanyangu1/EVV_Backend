# Generated by Django 5.2 on 2025-12-06 05:57

import datetime
import django.core.validators
import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Client',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('client_id', models.CharField(max_length=50, unique=True)),
                ('first_name', models.CharField(max_length=100)),
                ('last_name', models.CharField(max_length=100)),
                ('middle_name', models.CharField(blank=True, max_length=100, null=True)),
                ('dob', models.DateField()),
                ('gender', models.CharField(blank=True, choices=[('Male', 'Male'), ('Female', 'Female'), ('Other', 'Other')], max_length=10, null=True)),
                ('email', models.EmailField(blank=True, max_length=254, null=True)),
                ('phone', models.CharField(blank=True, max_length=20, null=True)),
                ('address_line1', models.CharField(blank=True, max_length=255, null=True)),
                ('address_line2', models.CharField(blank=True, max_length=255, null=True)),
                ('city', models.CharField(blank=True, max_length=100, null=True)),
                ('state', models.CharField(default='AZ', max_length=2)),
                ('zip_code', models.CharField(blank=True, max_length=10, null=True)),
                ('county', models.CharField(blank=True, max_length=100, null=True)),
                ('medicaid_id', models.CharField(blank=True, max_length=9, null=True)),
                ('payor', models.CharField(choices=[('Medicaid', 'Medicaid'), ('Medicare', 'Medicare'), ('Private', 'Private Insurance'), ('Self Pay', 'Self Pay'), ('Other', 'Other')], default='Medicaid', max_length=20)),
                ('insurance_id', models.CharField(blank=True, max_length=50, null=True)),
                ('primary_diagnosis', models.CharField(blank=True, max_length=255, null=True)),
                ('secondary_diagnosis', models.CharField(blank=True, max_length=255, null=True)),
                ('physician_name', models.CharField(blank=True, max_length=255, null=True)),
                ('physician_phone', models.CharField(blank=True, max_length=20, null=True)),
                ('case_manager_name', models.CharField(blank=True, max_length=255, null=True)),
                ('case_manager_phone', models.CharField(blank=True, max_length=20, null=True)),
                ('emergency_contact_name', models.CharField(blank=True, max_length=255, null=True)),
                ('emergency_contact_phone', models.CharField(blank=True, max_length=20, null=True)),
                ('emergency_contact_relation', models.CharField(blank=True, max_length=100, null=True)),
                ('service_location', models.CharField(choices=[('home', 'Home'), ('facility', 'Facility'), ('community', 'Community'), ('work', 'Work'), ('school', 'School')], default='home', max_length=20)),
                ('location_latitude', models.DecimalField(blank=True, decimal_places=6, help_text='Latitude coordinate for service location', max_digits=9, null=True)),
                ('location_longitude', models.DecimalField(blank=True, decimal_places=6, help_text='Longitude coordinate for service location', max_digits=9, null=True)),
                ('service_start_date', models.DateField(blank=True, null=True)),
                ('service_end_date', models.DateField(blank=True, null=True)),
                ('authorized_hours_weekly', models.DecimalField(blank=True, decimal_places=2, help_text='Authorized service hours per week', max_digits=5, null=True)),
                ('timezone', models.CharField(default='America/Phoenix', max_length=64)),
                ('assent_plan', models.CharField(choices=[('Yes', 'Yes'), ('No', 'No')], default='Yes', max_length=3)),
                ('language_preference', models.CharField(choices=[('English', 'English'), ('Spanish', 'Spanish'), ('Other', 'Other')], default='English', max_length=20)),
                ('mobility_requirements', models.TextField(blank=True, null=True)),
                ('special_instructions', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Client',
                'verbose_name_plural': 'Clients',
                'db_table': 'evv_clients',
                'ordering': ['last_name', 'first_name'],
            },
        ),
        migrations.CreateModel(
            name='Employee',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('employee_id', models.CharField(max_length=50, unique=True)),
                ('first_name', models.CharField(max_length=100)),
                ('last_name', models.CharField(max_length=100)),
                ('ssn', models.CharField(max_length=9, unique=True, validators=[django.core.validators.RegexValidator('^\\d{9}$', 'SSN must be exactly 9 digits')])),
                ('date_of_birth', models.DateField(default='2000-01-01')),
                ('address_line1', models.CharField(default='Temporary Address', max_length=255)),
                ('address_line2', models.CharField(blank=True, max_length=255, null=True)),
                ('city', models.CharField(default='Phoenix', max_length=100)),
                ('state', models.CharField(default='AZ', max_length=2)),
                ('zip_code', models.CharField(default='85001', max_length=10, validators=[django.core.validators.RegexValidator('^\\d{5}(-\\d{4})?$', 'Invalid ZIP code format')])),
                ('phone', models.CharField(default='0000000000', max_length=10, validators=[django.core.validators.RegexValidator(message='Phone number must be 10 digits without spaces or special characters', regex='^\\d{10}$')])),
                ('email', models.EmailField(default='temp@example.com', max_length=254)),
                ('hire_date', models.DateField(default='2024-01-01')),
                ('position', models.CharField(default='Caregiver', max_length=100)),
                ('department', models.CharField(blank=True, max_length=100, null=True)),
                ('pay_type', models.CharField(choices=[('hourly', 'Hourly'), ('salary', 'Salary')], default='hourly', max_length=10)),
                ('pay_rate', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('employment_type', models.CharField(choices=[('full-time', 'Full-Time'), ('part-time', 'Part-Time'), ('contract', 'Contract'), ('temporary', 'Temporary')], default='full-time', max_length=20)),
                ('emergency_contact_name', models.CharField(default='Temp Contact', max_length=200)),
                ('emergency_contact_phone', models.CharField(default='0000000000', max_length=10, validators=[django.core.validators.RegexValidator(message='Phone number must be 10 digits without spaces or special characters', regex='^\\d{10}$')])),
                ('emergency_contact_relation', models.CharField(blank=True, max_length=100, null=True)),
                ('status', models.CharField(choices=[('active', 'Active'), ('inactive', 'Inactive'), ('on_leave', 'On Leave'), ('terminated', 'Terminated')], default='active', max_length=20)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('evv_id', models.CharField(blank=True, max_length=50, null=True, unique=True)),
                ('last_evv_sync', models.DateTimeField(blank=True, null=True)),
                ('evv_status', models.CharField(choices=[('not_synced', 'Not Synced'), ('synced', 'Synced'), ('pending', 'Pending'), ('error', 'Error')], default='not_synced', max_length=20)),
                ('user', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='employee_profile', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['last_name', 'first_name'],
            },
        ),
        migrations.CreateModel(
            name='ClientEmployeeXref',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('xref_other_id', models.CharField(help_text='Unique identifier in external system', max_length=50, unique=True)),
                ('sequence_id', models.IntegerField(default=1, help_text='Incremented for each update')),
                ('start_date', models.DateField(default=datetime.date.today, help_text='Date when relationship began')),
                ('end_date', models.DateField(blank=True, help_text='Date when relationship ended (NULL for ongoing)', null=True)),
                ('payer_id', models.CharField(choices=[('AZACH', 'AZACH'), ('AZBUFC', 'AZBUFC'), ('AZCCCS', 'AZCCCS'), ('AZCDMP', 'AZCDMP'), ('AZDDD', 'AZDDD'), ('AZMCC', 'AZMCC'), ('AZMYC', 'AZMYC'), ('AZSHC', 'AZSHC'), ('AZUCP', 'AZUCP')], default='AZDDD', max_length=10)),
                ('payer_program', models.CharField(default='AHCCCS', help_text="Must be 'AHCCCS' per spec", max_length=20)),
                ('procedure_code', models.CharField(help_text='HCPCS code (see Section 10.10 of spec)', max_length=10)),
                ('modifier1', models.CharField(blank=True, max_length=2, null=True)),
                ('modifier2', models.CharField(blank=True, max_length=2, null=True)),
                ('modifier3', models.CharField(blank=True, max_length=2, null=True)),
                ('modifier4', models.CharField(blank=True, max_length=2, null=True)),
                ('live_in', models.CharField(choices=[('Yes', 'Yes'), ('No', 'No')], default='No', max_length=10)),
                ('relationship', models.CharField(choices=[('Spouse', 'Spouse'), ('Adult children/Stepchildren', 'Adult children/Stepchildren'), ('Son-in-law/Daughter-in-law', 'Son-in-law/Daughter-in-law'), ('Grandchildren', 'Grandchildren'), ('Siblings/Step siblings', 'Siblings/Step siblings'), ('Parents/Adoptive Parents/Legal Guardians', 'Parents/Adoptive Parents/Legal Guardians'), ('Stepparents', 'Stepparents'), ('Grandparents', 'Grandparents'), ('Mother-in-law/Father-in-law', 'Mother-in-law/Father-in-law'), ('Brother-in-law/Sister-in-law', 'Brother-in-law/Sister-in-law'), ('Other', 'Other')], default='Other', max_length=64)),
                ('submitted_to_evv', models.BooleanField(default=False)),
                ('evv_submission_id', models.CharField(blank=True, max_length=100, null=True)),
                ('evv_submission_date', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='evv.client')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='evv.employee')),
            ],
            options={
                'verbose_name': 'Client-Employee Relationship',
                'verbose_name_plural': 'Client-Employee Relationships',
            },
        ),
        migrations.CreateModel(
            name='Claim',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('claim_id', models.CharField(max_length=50, unique=True)),
                ('service_date', models.DateField()),
                ('service_code', models.CharField(max_length=20)),
                ('billing_code', models.CharField(max_length=20)),
                ('units', models.DecimalField(decimal_places=2, max_digits=10)),
                ('rate', models.DecimalField(decimal_places=2, max_digits=10)),
                ('total_amount', models.DecimalField(decimal_places=2, max_digits=10)),
                ('payer_id', models.CharField(choices=[('AZDDD', 'AZDDD'), ('AZCCCS', 'AZCCCS'), ('AZACH', 'AZACH')], default='AZDDD', max_length=20)),
                ('payer_program', models.CharField(default='AHCCCS', max_length=20)),
                ('modifier1', models.CharField(blank=True, max_length=4, null=True)),
                ('modifier2', models.CharField(blank=True, max_length=4, null=True)),
                ('modifier3', models.CharField(blank=True, max_length=4, null=True)),
                ('modifier4', models.CharField(blank=True, max_length=4, null=True)),
                ('status', models.CharField(choices=[('Submitted', 'Submitted'), ('Approved', 'Approved'), ('Rejected', 'Rejected'), ('Pending', 'Pending')], default='Submitted', max_length=20)),
                ('notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='evv.client')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='evv.employee')),
            ],
        ),
        migrations.CreateModel(
            name='Visit',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('visit_other_id', models.CharField(help_text='Unique visit identifier for EVV (generated automatically)', max_length=100, unique=True)),
                ('sequence_id', models.CharField(help_text='EVV Sequence ID (YYYYMMDDHHMMSS format)', max_length=16)),
                ('visit_type', models.CharField(choices=[('scheduled', 'Scheduled (No Calls)'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('cancelled', 'Cancelled'), ('no_show', 'No Show')], default='scheduled', max_length=20)),
                ('schedule_start_time', models.DateTimeField(blank=True, help_text='Scheduled start time (UTC)', null=True)),
                ('schedule_end_time', models.DateTimeField(blank=True, help_text='Scheduled end time (UTC)', null=True)),
                ('actual_start_time', models.DateTimeField(blank=True, help_text='Actual check-in time (UTC)', null=True)),
                ('actual_end_time', models.DateTimeField(blank=True, help_text='Actual check-out time (UTC)', null=True)),
                ('start_latitude', models.DecimalField(blank=True, decimal_places=7, help_text='Check-in latitude', max_digits=10, null=True)),
                ('start_longitude', models.DecimalField(blank=True, decimal_places=7, help_text='Check-in longitude', max_digits=10, null=True)),
                ('end_latitude', models.DecimalField(blank=True, decimal_places=7, help_text='Check-out latitude', max_digits=10, null=True)),
                ('end_longitude', models.DecimalField(blank=True, decimal_places=7, help_text='Check-out longitude', max_digits=10, null=True)),
                ('location_verified', models.BooleanField(default=False)),
                ('location_distance_miles', models.DecimalField(blank=True, decimal_places=2, help_text='Distance from client location in miles', max_digits=6, null=True)),
                ('payer_id', models.CharField(default='AZDDD', help_text='EVV Payer ID', max_length=10)),
                ('procedure_code', models.CharField(default='T1019', help_text='EVV procedure code', max_length=10)),
                ('visit_time_zone', models.CharField(default='US/Arizona', help_text='Timezone for visit', max_length=50)),
                ('client_verified_times', models.BooleanField(default=False)),
                ('client_verified_tasks', models.BooleanField(default=False)),
                ('client_verified_service', models.BooleanField(default=False)),
                ('client_signature_available', models.BooleanField(default=False)),
                ('client_voice_recording', models.BooleanField(default=False)),
                ('bill_visit', models.BooleanField(default=True)),
                ('hours_to_bill', models.DecimalField(decimal_places=3, default=0.0, max_digits=10, validators=[django.core.validators.MinValueValidator(0)])),
                ('hours_to_pay', models.DecimalField(decimal_places=3, default=0.0, max_digits=10, validators=[django.core.validators.MinValueValidator(0)])),
                ('tasks_completed', models.JSONField(default=list, help_text='List of completed task IDs')),
                ('tasks_refused', models.JSONField(default=list, help_text='List of refused task IDs')),
                ('calls', models.JSONField(default=list, help_text='EVV call records with timestamps and GPS')),
                ('visit_changes', models.JSONField(default=list, help_text='EVV visit change records')),
                ('memo', models.TextField(blank=True, help_text='Free text notes about visit')),
                ('contingency_plan', models.CharField(blank=True, help_text='CP01-CP05 or empty', max_length=5)),
                ('submitted_to_evv', models.BooleanField(default=False)),
                ('evv_submission_id', models.CharField(blank=True, max_length=100)),
                ('evv_submission_date', models.DateTimeField(blank=True, null=True)),
                ('evv_response', models.JSONField(blank=True, help_text='Raw response from EVV system', null=True)),
                ('evv_errors', models.JSONField(default=list, help_text='List of EVV submission errors if any')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='visits', to='evv.client')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_visits', to='evv.employee')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='visits', to='evv.employee')),
            ],
            options={
                'verbose_name': 'EVV Visit',
                'verbose_name_plural': 'EVV Visits',
                'db_table': 'evv_visits',
                'ordering': ['-schedule_start_time'],
            },
        ),
        migrations.AddIndex(
            model_name='employee',
            index=models.Index(fields=['last_name', 'first_name'], name='evv_employe_last_na_3d8f5c_idx'),
        ),
        migrations.AddIndex(
            model_name='employee',
            index=models.Index(fields=['status'], name='evv_employe_status_e73c96_idx'),
        ),
        migrations.AddIndex(
            model_name='employee',
            index=models.Index(fields=['evv_status'], name='evv_employe_evv_sta_de79ac_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='clientemployeexref',
            unique_together={('client', 'employee')},
        ),
        migrations.AddIndex(
            model_name='visit',
            index=models.Index(fields=['client', 'schedule_start_time'], name='evv_visits_client__94a9dd_idx'),
        ),
        migrations.AddIndex(
            model_name='visit',
            index=models.Index(fields=['employee', 'schedule_start_time'], name='evv_visits_employe_55c8cc_idx'),
        ),
        migrations.AddIndex(
            model_name='visit',
            index=models.Index(fields=['visit_type'], name='evv_visits_visit_t_5502cb_idx'),
        ),
        migrations.AddIndex(
            model_name='visit',
            index=models.Index(fields=['submitted_to_evv'], name='evv_visits_submitt_15cfbc_idx'),
        ),
        migrations.AddIndex(
            model_name='visit',
            index=models.Index(fields=['visit_other_id'], name='evv_visits_visit_o_a26311_idx'),
        ),
    ]
